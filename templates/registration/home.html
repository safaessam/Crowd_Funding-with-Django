{% extends 'base.html' %} {% load static %} {% block title %}Home{% endblock %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}" />
{% endblock %} {% block body %}
<div class="container">
  <title>Search Projects</title>

  <h1>Project Search</h1>

  <!-- Assuming you have a search form in your HTML with an ID of 'searchForm' and a results container with an ID of 'searchResults' -->
  <form id="searchForm" method="GET" action="{% url 'search_projects' %}">
    <input type="text" name="query" placeholder="Search for projects" />
    <button type="submit">Search</button>
  </form>

  <div id="searchResults"></div>

  <script>
    const searchForm = document.getElementById("searchForm");
    const searchResultsContainer = document.getElementById("searchResults");

    searchForm.addEventListener("submit", (event) => {
      event.preventDefault();

      const query = searchForm.elements.query.value;

      fetch(`${searchForm.action}?query=${encodeURIComponent(query)}`)
        .then((response) => response.text())
        .then((data) => {
          searchResultsContainer.innerHTML = data;
        })
        .catch((error) => {
          console.error(error);
          // Handle error response
        });
    });
  </script>

  <!-- Slider to show the highest five rated running projects -->
  <h2>Highest Rated Projects</h2>
  <div class="slider">
    <!-- Add your slider code here -->
    <!-- Display the highest five rated running projects -->
    {% for project in highest_rated_projects %}
    <div class="slide">
      <h3>{{ project.title }}</h3>
      <h3>{{ project.details }}</h3>
      <h3>Donate:</h3>
      {{ project.donate }}
      <h3>Category:</h3>
      {{ project.category }}
      <h3>Total Target:</h3>
      {{ project.target_amount }}
      <h3>Average Rating:</h3>
      {{ average_rating }}
      <h3>Donations:</h3>
      <div class="donations">
        {% for donation in project.donations.all %}
        <p>{{ donation.user.username }} donated {{ donation.amount }}</p>
        {% empty %}
        <p>No donations yet.</p>
        {% endfor %}
      </div>
      {% endfor %}
    </div>

    <!-- List of the latest 5 projects -->
    <h2>Latest Projects</h2>
    <div class="d-flex justify-content-center gap-5">
      {% for project in latest_projects %}
      <div class="card" style="width: 18rem">
        <img
          src="{{ project.image_url }}"
          class="card-img-top"
          alt="{{ project.title }}"
        />
        <div class="card-body">
          <h5 class="card-title">{{ project.title }}</h5>
          <p class="card-text">{{ project.details }}</p>
          <a
            href="{% url 'project_detail' project_id=project.id %}"
            class="btn btn-primary"
            >Go to Project</a
          >
        </div>
      </div>
      {% endfor %}
    </div>
    <!-- List of categories -->

    <div class="pt-3">
      <div class="card text-center">
        <div class="card-header">Categories</div>
        <div class="card-body">
          <h5 class="card-title">Thank you for Helping People</h5>
          <p class="card-text">for the people by the people</p>
          <ul>
            {% for category in categories %}
            <li>
              <a
                href="{% url 'category_projects' category.id %}"
                class="btn btn-secondary"
              >
                {{ category.name }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    {% endblock %}
  </div>
</div>
